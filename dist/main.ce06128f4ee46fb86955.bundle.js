webpackJsonp([1],{0:function(e,t,n){e.exports=n("x35b")},"1kG0":function(e,t){e.exports='<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top" style="line-height: 2.68">\n  <a class="navbar-brand" routerLink="/" routerLinkActive="active"\n     [routerLinkActiveOptions]="{exact:true}">\n    Glaucoma Risk Calculator\n  </a>\n\n  <div class="collapse navbar-collapse" id="navbarsExampleDefault">\n    <form class="form-inline col btn-group" *ngIf="authService.loggedIn()">\n      <a class="nav-item nav-link btn btn-outline-info" routerLinkActive="active" routerLink="/admin/dashboard">\n        Dashboard\n      </a>\n      <button class="a nav-item nav-link btn" (click)="logout()">\n        Logout\n      </button>\n    </form>\n    <ul class="navbar-nav mr-auto"></ul>\n    <a href="http://glaucoma.org.au"><img src="../../assets/reversed-logo.png" alt="logo"/></a>\n  </div>\n\n</nav>\n\n<nav class="navbar navbar-expand-md navbar-dark bg-dark fixed-top"\n     *ngIf="alertsService.alerts">\n  <app-alerts style="width: 100%"></app-alerts>\n</nav>\n'},"3f7S":function(e,t){e.exports=""},"3wRP":function(e,t){e.exports='<form [formGroup]="form">\n  <quill-editor #editor id="{{elementId}}" [style]="{height: \'200px\'}"\n                (onEditorCreated)="setFocus($event)"\n                [formControl]="form.controls[\'editor\']"></quill-editor>\n</form>\n'},"4nrF":function(e,t){e.exports='<main *ngIf="!submitted">\n  <h5>Complete the following to calculate your risk of developing glaucoma, and what to do about it.</h5>\n\n  <form [formGroup]="riskForm" *ngIf="active" (ngSubmit)="onSubmit()">\n    <span class="form-check-label label" style="padding-left: 0">Gender</span>\n    <fieldset class="form-group" id="gender" name="gender">\n      <div class="form-check">\n        <label class="form-check-label">\n          <input type="radio" class="form-check-input" name="gender" id="male" value="male"\n                 formControlName="gender" tabindex="0">\n          Male\n        </label>\n      </div>\n      <div class="form-check">\n        <label class="form-check-label">\n          <input type="radio" class="form-check-input" name="gender" id="female" value="female"\n                 formControlName="gender">\n          Female\n        </label>\n      </div>\n      <div *ngIf="formErrors.gender" class="alert alert-danger">\n        {{ formErrors.gender }}\n      </div>\n    </fieldset>\n\n    <div class="form-group">\n      <label for="age">Age</label>\n      <input type="number" id="age" class="form-control"\n             formControlName="age" placeholder="Specify age">\n    </div>\n\n    <div class="form-group">\n      <label for="ethnicity">Ethnicity</label>\n      <ngx-select [items]="ethnicities"\n                  (selected)="selected_ethnicity($event)"\n                  (data)="selected_ethnicity($event)"\n                  (close)="doClose()"\n                  id="ethnicity" formControlName="ethnicity"\n                  placeholder="Search for ethnicity">\n      </ngx-select>\n    </div>\n\n    <div class="container-fluid">\n      <div class="row">\n        <fieldset class="col-sm">\n          <legend>Family history of glaucoma</legend>\n\n          <div class="form-check form-check-inline container">\n            <div class="row">\n              <label class="form-check-label col col-sm">\n                Parent\n                <input class="form-control form-check-input" type="checkbox" id="parent" formControlName="parent">\n              </label>\n              <label class="form-check-label col col-sm">\n                Sibling\n                <input class="form-control form-check-input" type="checkbox" id="sibling" formControlName="sibling">\n              </label>\n            </div>\n          </div>\n        </fieldset>\n\n        <fieldset class="col-sm">\n          <legend>Other health issues</legend>\n\n          <div class="form-check form-check-inline container">\n            <div class="row">\n              <label class="form-check-label col col-sm">\n                Myopia\n                <input class="form-control form-check-input" type="checkbox" id="myopia" formControlName="myopia">\n              </label>\n              <label class="form-check-label col col-sm">\n                Diabetes\n                <input class="form-control form-check-input" type="checkbox" id="diabetes" formControlName="diabetes">\n              </label>\n            </div>\n          </div>\n        </fieldset>\n\n        <div class="col-sm" style="padding-top: 15px">\n          <button type="submit" class="submit btn " style="width: 100%; height: 100%"\n                  [class.btn-primary]="riskForm.valid"\n                  [class.btn-outline-secondary]="!riskForm.valid"\n                  [disabled]="!riskForm.valid">\n            Calculate risk\n          </button>\n        </div>\n      </div>\n    </div>\n  </form>\n</main>\n\n<app-risk-quiz-form-submitted [riskQuiz]="riskQuiz" [(submitted)]="submitted" *ngIf="submitted">\n</app-risk-quiz-form-submitted>\n'},"5LyI":function(e,t){e.exports="body {\n  padding-top: 150px;\n}\n"},"5xMp":function(e,t){e.exports='<header [ngStyle]="getBottom()">\n  <app-navbar></app-navbar>\n</header>\n\n<div class="container">\n  <router-outlet></router-outlet>\n</div>\n\x3c!--\n<hr>\n\n<div class="container">\n  <div class="row offset-sm-9">\n    <button class="btn btn-lg btn-danger"\n            (click)="addAlert()">Add alert</button>\n  </div>\n</div>\n--\x3e\n<hr>\n\n<app-footer></app-footer>\n'},"7zrD":function(e,t,n){"use strict";n.d(t,"a",function(){return c});var i=n("WT6e"),r=n("g5jc"),o=n("4zOZ"),s=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},a=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},c=function(){function e(){this._navbarPadding=16,this.navbarPaddingChange=new r.a,this.navbarPadding$=new o.a(this._navbarPadding)}return Object.defineProperty(e.prototype,"navbarPadding",{get:function(){return this._navbarPadding},set:function(e){this._navbarPadding=e,this.navbarPadding$.next(this._navbarPadding)},enumerable:!0,configurable:!0}),e=s([Object(i.Injectable)(),a("design:paramtypes",[])],e)}()},"8xD6":function(e,t){e.exports=""},DBiG:function(e,t){e.exports=""},FQYD:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("WT6e"),r=n("Xjw4"),o=n("bfOx"),s=n("7DMc"),a=n("dcgx"),c=n("OZ26"),l=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},u=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},f=function(){function e(e,t,n,i){this.router=e,this.fb=t,this.authService=n,this.alertsService=i,this.auth=new s.b}return e.prototype.ngOnInit=function(){this.form=this.fb.group({email:["",[s.h.required,s.h.email]],password:["",s.h.required]})},e.prototype.login=function(){var e=this;this.authService.login(this.form.value).subscribe(function(t){var n;null!=t.access_token?(e.authService.access_token=t.access_token,localStorage.setItem("access-token",e.authService.access_token),e.router.navigate([(n="/admin",new URLSearchParams(window.location.search.slice(1)).get("redirectUrl")||n)]).then(function(){})):e.alertsService.add("No access token; try logging in again")})},e=l([Object(i.Component)({selector:"app-login",template:n("Y0uS"),styles:[n("cbOW")]}),u("design:paramtypes",[o.b,s.a,a.a,c.a])],e)}(),p=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},d=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(){function e(e){this.authService=e}return e.prototype.ngOnInit=function(){this.authService.logout()},e=p([Object(i.Component)({selector:"app-logout",template:"<ng-content></ng-content>"}),d("design:paramtypes",[a.a])],e)}(),m=[{path:"auth",component:f},{path:"auth/login",component:f},{path:"auth/logout",component:h}];n.d(t,"AuthModule",function(){return b});var g=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},b=function(){function e(){}return e=g([Object(i.NgModule)({imports:[r.CommonModule,o.c,o.c.forChild(m),s.c,s.g],providers:[a.a],declarations:[f,h]})],e)}()},FrLf:function(e,t){e.exports='<div class="container-fluid">\n  <div class="row">\n    <div class="col-9">\n      <app-email-tpl></app-email-tpl>\n    </div>\n    <div class="col">\n      <app-ms-auth></app-ms-auth>\n    </div>\n  </div>\n</div>\n'},"GFD+":function(e,t){e.exports=""},IH5k:function(e,t){e.exports=""},Igq0:function(e,t){e.exports='<div class="container">\n  <div class="row">\n    <a type="button" class="col btn btn-lg btn-warning" (click)="login()" *ngIf="!loggedIn()">\n      Authenticate with Office 365\n    </a>\n\n    <button class="col btn btn-sm btn-outline-danger"\n            (click)="logout()" *ngIf="loggedIn()">\n      Office 365 logout\n    </button>\n    <button type="button" class="col-sm-2 btn btn-sm" (click)="toggleCollapse()">Advanced</button>\n  </div>\n</div>\n\n<form *ngIf="loggedIn()" (ngSubmit)="sendTestEmail()">\n  <div class="form-group">\n    <label for="recipient">Recipient</label>\n    <input type="email" class="form-control" id="recipient" name="recipient"\n           aria-describedby="emailHelp" placeholder="Enter email" [(ngModel)]="mail_base.recipient">\n    <small id="emailHelp" class="form-text text-muted">Address to send email</small>\n  </div>\n\n  <div class="form-group">\n    <label for="subject">Subject</label>\n    <input type="text" class="form-control" id="subject" name="subject"\n           aria-describedby="subjectHelp" placeholder="Enter subject" [(ngModel)]="mail_base.subject">\n    <small id="subjectHelp" class="form-text text-muted">Subject of email</small>\n  </div>\n\n  <button class="btn btn-lg btn-primary" type="submit">Send test email</button>\n</form>\n\n<hr *ngIf="!isCollapsed">\n\n<div [collapse]="isCollapsed" class="card card-block card-header">\n  <div class="well well-lg">\n    More info:\n    <a href="https://graph.microsoft.io/en-us/docs/authorization/app_authorization" target="_blank">\n      Microsoft Graph app authorisation\n    </a>\n    <form (ngSubmit)="updateAuth()">\n      <div class="form-group">\n        <label for="recipient">Client ID</label>\n        <input type="text" class="form-control" id="client_id" name="client_id"\n               placeholder="Enter client_id" [(ngModel)]="client_id">\n      </div>\n\n      <div class="form-group">\n        <label for="recipient">Tenant ID</label>\n        <input type="text" class="form-control" id="tenant_id" name="tenant_id"\n               placeholder="Enter tenant_id" [(ngModel)]="tenant_id">\n      </div>\n\n      <button class="btn btn-outline-warning" type="submit">Update auth</button>\n    </form>\n  </div>\n</div>\n\n'},Jnfr:function(e,t,n){var i={"app/auth/auth.module":["FQYD"]};function r(e){var t=i[e];return t?Promise.all(t.slice(1).map(n.e)).then(function(){return n(t[0])}):Promise.reject(new Error("Cannot find module '"+e+"'."))}r.keys=function(){return Object.keys(i)},r.id="Jnfr",e.exports=r},N6X2:function(e,t){e.exports='<app-richtext [elementId]="\'tpl\'" (onEdited)="onEdited($event)" #editor>\n</app-richtext>\n<button type="submit" class="btn btn-info btn-lg" (click)="save()">Save</button>\n'},OZ26:function(e,t,n){"use strict";n.d(t,"a",function(){return a});var i=n("WT6e"),r=n("7zrD"),o=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},s=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},a=function(){function e(e){this.appService=e,this.alerts=[],this._padding=4.5}return e.prototype.add=function(e){var t,n="string"==typeof(t=e&&("string"==typeof e?e:e instanceof Error?e.message:Object.keys(e).map(function(t){return e[t]}).join("\t"))||"undefined alert")?t:Object.keys(t).map(function(e){return e+" => "+t[e]}).join(" ");console.info("Alert =",e),this.alerts.push({type:"warning",msg:n}),this.appService.navbarPadding+=this._padding},e.prototype.close=function(e){this.alerts.splice(e,1),this.appService.navbarPadding-=this._padding},e=o([Object(i.Injectable)(),s("design:paramtypes",[r.a])],e)}()},QjeQ:function(e,t){e.exports='<div class="row">\n  <div class="col-md-4">\n    <input *ngIf="config.filtering" placeholder="Filter all columns"\n           [ngTableFiltering]="config.filtering"\n           class="form-control"\n           (tableChanged)="onChangeTable(config)"/>\n  </div>\n</div>\n<br>\n<ng-table [config]="config"\n          (tableChanged)="onChangeTable(config)"\n          (cellClicked)="onCellClick($event)"\n          [rows]="users" [columns]="columns">\n</ng-table>\n<pagination *ngIf="config.paging"\n            class="pagination-sm"\n            [(ngModel)]="page"\n            [totalItems]="length"\n            [itemsPerPage]="itemsPerPage"\n            [maxSize]="maxSize"\n            [boundaryLinks]="true"\n            [rotate]="false"\n            (pageChanged)="onChangeTable(config, $event)"\n            (numPages)="numPages = $event">\n</pagination>\n<pre *ngIf="config.paging" class="card card-block card-header">Page: {{page}} / {{numPages}}</pre>\n\n'},Rpt0:function(e,t){e.exports='<div class="jumbotron">\n  <div class="container">\n    <h1 class="display-4">Administrator interface</h1>\n    <p>Herein you can edit email templates, and modify email API details.</p>\n  </div>\n</div>\n\n<div class="container">\n  <div class="row">\n    <div class="col-md-6">\n      <a class="btn btn-block btn-outline-primary" routerLink="/admin/email" routerLinkActive="active">\n        <i class="icon-mail"></i> Manage email\n      </a>\n      <p>Edit email template, modify authentication details</p>\n    </div>\n    <div class="col-md-6">\n      <button class="btn btn-block btn-outline-danger" routerLink="/admin/users" routerLinkActive="active">\n        <i class="icon-users"></i>Users\n      </button>\n      <p>View/search users</p>\n    </div>\n  </div>\n</div>\n'},SiWZ:function(e,t){e.exports="legend {\n  font-size: medium;\n  font-weight: bold;\n}\n\n.form-check-label {\n  font-weight: unset;\n}\n\nlabel, .label {\n  font-weight: bold;\n}\n\n.btn:not(:disabled):not(.disabled) {\n  font-weight: bold;\n}\n"},T7K8:function(e,t){e.exports="/*\n * Top navigation\n * Hide default border to remove 1px line.\n */\n.navbar-fixed-top {\n  border: 0;\n}\n"},UfTw:function(e,t){e.exports=""},Y0uS:function(e,t){e.exports='<h1 class="mat-h1">Login</h1>\n\n<form class="form-signin-up" #formRef="ngForm" (ngSubmit)="login()" *ngIf="!authService.loggedIn()" [formGroup]="form"\n      novalidate>\n  <label for="email" class="sr-only">Email address</label>\n  <input class="form-control" formControlName="email" type="email" name="email" id="email" placeholder="Email">\n\n  <label for="password" class="sr-only">Password</label>\n  <input class="form-control" formControlName="password" type="password" name="password" id="password"\n         placeholder="Password">\n\n\n  <button class="btn btn-lg btn-primary btn-block" type="submit">Sign in</button>\n</form>\n\n<p *ngIf="authService.loggedIn()">You are logged in.</p>\n'},cbOW:function(e,t){e.exports=""},cmvB:function(e,t){e.exports=""},dcgx:function(e,t,n){"use strict";n.d(t,"a",function(){return u});var i=n("WT6e"),r=n("ItHS"),o=n("bfOx"),s=n("YaPU"),a=(n("xgm2"),n("owTz"),n("MDfR"),n("OZ26")),c=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},l=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},u=function(){function e(e,n,i){this.http=e,this.router=n,this.alertsService=i,this.loggedIn=t.loggedIn;var r=localStorage.getItem("access-token");null!=r&&(this.access_token=r)}return t=e,e.loggedIn=function(){return null!==localStorage.getItem("access-token")},e.getAccessToken=function(){return localStorage.getItem("access-token")},e.prototype.logout=function(){localStorage.removeItem("access-token"),localStorage.removeItem("user"),this.router.navigate(["/"],"/auth/logout"===this.router.url?{}:{queryParams:{redirectUrl:this.router.url}})},e.prototype._login=function(e){this.access_token=e.access_token,localStorage.setItem("access-token",this.access_token)},e.prototype.login=function(e){return localStorage.setItem("user",e.email),this.http.post("/api/auth",e)},e.prototype.register=function(e){return localStorage.setItem("user",e.email),this.http.post("/api/user",e,{observe:"response"})},e.prototype.signinup=function(e){var t=this;return this.login(e).catch(function(n){return n&&n.error&&n.error.message&&"User not found"===n.error.message?t.register(e).map(function(e){return Object.assign(e.body,{access_token:e.headers.get("X-Access-Token")})}):t.alertsService.add(n.error.message)||s.a.throw(n.error)})},e=t=c([Object(i.Injectable)(),l("design:paramtypes",[r.b,o.b,a.a])],e);var t}()},e6R8:function(e,t){e.exports="ng-gauge {\n  margin: 16px;\n  width: 300px;\n  height: 300px;\n  display: inline-block;\n}\n"},f6ft:function(e,t){e.exports='<footer class="footer container">\n  <div class="row align-items-start">\n    <app-api-version class="col grey"></app-api-version>\n    <a routerLink="/auth" class="col grey text-center">auth</a>\n    <span class="col text-right">&copy; Glaucoma Australia, 2018.</span>\n  </div>\n</footer>\n'},lEF6:function(e,t){e.exports='<table class="table">\n  <tbody>\n  <tr>\n    <td [style.background]="numToColour(0)"></td>\n    <td [style.background]="numToColour(25)"></td>\n    <td [style.background]="numToColour(50)"></td>\n    <td [style.background]="numToColour(75)"></td>\n    <td [style.background]="numToColour(100)"></td>\n  </tr>\n  <tr>\n    <td id="0">{{risk_value}}</td>\n    <td id="1"></td>\n    <td id="2"></td>\n    <td id="3"></td>\n    <td id="4"></td>\n    <td id="5"></td>\n  </tr>\n  </tbody>\n</table>\n'},mIxc:function(e,t){e.exports=".grey {\n  color: gainsboro;\n}\n"},mR2D:function(e,t){e.exports=""},okgc:function(e,t){e.exports="a {\n  text-decoration: none;\n}\n\na.active {\n  font-weight: bold;\n}\n\nhtml {\n  position: relative;\n  min-height: 100%;\n}\n"},vqKx:function(e,t){e.exports='<ng-container *ngIf="serverStatus.version">\n  {{serverStatus.version}}\n</ng-container>\n'},x35b:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=n("WT6e"),r=n("4PVY"),o=n("OE0E"),s=n("ItHS"),a=n("7DMc"),c=n("bfOx"),l=n("Xjw4"),u=n("Exih"),f=n("OZ26"),p=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},d=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},h=function(){function e(e){this.alertsService=e,this.type="warning"}return e.prototype.ngOnInit=function(){},e.prototype.addAlert=function(e){this.alertsService.add(e)},e.prototype.closeAlert=function(e){this.alertsService.close(e)},p([Object(i.Input)(),d("design:type",Object)],e.prototype,"type",void 0),p([Object(i.Input)(),d("design:type",Boolean)],e.prototype,"dismissible",void 0),p([Object(i.Input)(),d("design:type",Number)],e.prototype,"dismissOnTimeout",void 0),e=p([Object(i.Component)({selector:"app-alerts",template:n("y69F"),providers:[u.a],styles:[n("5LyI")]}),d("design:paramtypes",[f.a])],e)}(),m=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},g=function(){function e(){}return e=m([Object(i.NgModule)({imports:[l.CommonModule,u.b.forRoot()],declarations:[h],exports:[h]})],e)}(),b=n("dcgx"),y=n("7zrD"),v=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},_=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},k=function(){function e(e,t,n,i){this.router=e,this.appService=t,this.authService=n,this.alertsService=i}return e.prototype.logout=function(){var e=this;this.router.navigate(["auth/logout"]).then(function(t){return t?console.info("state changed"):e.alertsService.alerts.push({msg:"state didn't change",type:"warning"})},function(t){return e.alertsService.alerts.push({msg:t,type:"danger"})})},e=v([Object(i.Component)({selector:"app-navbar",template:n("1kG0"),styles:[n("T7K8")]}),_("design:paramtypes",[c.b,y.a,b.a,f.a])],e)}(),j=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},O=function(){function e(){}return e=j([Object(i.NgModule)({imports:[l.CommonModule,c.c,u.b,g],declarations:[k],exports:[k]})],e)}(),R=n("rMpt"),S=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},w=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},P=function(){function e(){}return e=S([Object(i.Component)({selector:"app-email",template:n("FrLf"),styles:[n("UfTw")]}),w("design:paramtypes",[])],e)}(),x=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},C=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},I=function(){function e(e){this.http=e}return e.prototype.post=function(e){return this.http.post("/api/user",e)},e.prototype.getAll=function(){return this.http.get("/api/users")},e=x([Object(i.Injectable)(),C("design:paramtypes",[s.b])],e)}(),z=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},A=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Q=function(){function e(e){this.userService=e,this.users=[],this.columns=[{title:"email",name:"email",filtering:{filterString:"",placeholder:"Filter by email"}},{title:"updatedAt",className:["office-header","text-success"],name:"updatedAt",sort:"asc"},{title:"createdAt.",name:"createdAt"}],this.config={paging:!0,sorting:{columns:this.columns},filtering:{filterString:""},className:["table-striped","table-bordered"]},this.page=1,this.itemsPerPage=10,this.maxSize=5,this.numPages=1,this.length=0}return e.prototype.ngOnInit=function(){var e=this;this.userService.getAll().map(function(e){return e.users}).subscribe(function(t){return e.users=t},console.error),this.onChangeTable(this.config)},e.prototype.changePage=function(e,t){void 0===t&&(t=this.users);var n=(e.page-1)*e.itemsPerPage,i=e.itemsPerPage>-1?n+e.itemsPerPage:t.length;return t.slice(n,i)},e.prototype.changeSort=function(e,t){if(!t.sorting)return e;for(var n=this.config.sorting.columns||[],i=void 0,r=void 0,o=0;o<n.length;o++)""!==n[o].sort&&!1!==n[o].sort&&(i=n[o].name,r=n[o].sort);return i?e.sort(function(e,t){return e[i]>t[i]?"desc"===r?-1:1:e[i]<t[i]?"asc"===r?-1:1:0}):e},e.prototype.changeFilter=function(e,t){var n=this,i=e;if(this.columns.forEach(function(e){e.filtering&&(i=i.filter(function(t){return t[e.name].match(e.filtering.filterString)}))}),!t.filtering)return i;if(t.filtering.columnName)return i.filter(function(e){return e[t.filtering.columnName].match(n.config.filtering.filterString)});var r=[];return i.forEach(function(e){var t=!1;n.columns.forEach(function(i){e[i.name].toString().match(n.config.filtering.filterString)&&(t=!0)}),t&&r.push(e)}),i=r},e.prototype.onChangeTable=function(e,t){void 0===t&&(t={page:this.page,itemsPerPage:this.itemsPerPage}),e.filtering&&Object.assign(this.config.filtering,e.filtering),e.sorting&&Object.assign(this.config.sorting,e.sorting);var n=this.changeFilter(this.users,this.config),i=this.changeSort(n,this.config);this.users=t&&e.paging?this.changePage(t,i):i,this.length=i.length},e.prototype.onCellClick=function(e){console.log(e)},e=z([Object(i.Component)({selector:"app-users",template:n("QjeQ"),styles:[n("mR2D")]}),A("design:paramtypes",[I])],e)}(),D=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},T=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},E=function(){function e(e,t){this.router=e,this.alertsService=t}return e.prototype.canActivate=function(e,t){if(b.a.loggedIn())return!0;var n=t.url;return this.alertsService.add("Auth required to view "+n),this.router.navigate(["/auth"],{queryParams:{redirectUrl:n}}).then(function(){}),!1},e=D([Object(i.Injectable)(),T("design:paramtypes",[c.b,f.a])],e)}(),M=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},F=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},N=function(){function e(e){this.router=e}return e=M([Object(i.Component)({selector:"app-dashboard",template:n("Rpt0"),styles:[n("DBiG")]}),F("design:paramtypes",[c.b])],e)}(),q=[{path:"admin/dashboard",component:N,canActivate:[E]},{path:"admin/users",component:Q,canActivate:[E]},{path:"admin/email",component:P,canActivate:[E]}],G=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},U=function(){function e(){}return e=G([Object(i.NgModule)({imports:[l.CommonModule,c.c.forChild(q),a.c,u.d.forRoot(),u.e,R.Ng2TableModule],providers:[I],declarations:[Q]})],e)}(),L=n("NOoU"),V=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},H=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},W=function(){function e(e){this.http=e}return e.prototype.hasTpl=function(){return!!this.email_tpl&&Object.keys(this.email_tpl).length>0&&!!this.email_tpl.tpl},e.prototype.setTpl=function(e){this.hasTpl()?this.email_tpl.tpl=e:this.email_tpl={tpl:e,createdAt:(new Date).toISOString()}},e.prototype.create=function(e){return this.http.post("/api/email_tpl",e)},e.prototype.read=function(e){return this.http.get("/api/email_tpl/"+e)},e.prototype.update=function(e,t){return this.http.put("/api/email_tpl/"+e.createdAt,t)},e.prototype.destroy=function(e){return this.http.delete("/api/email_tpl/"+e)},e=V([Object(i.Injectable)(),H("design:paramtypes",[s.b])],e)}(),B=n("YaPU"),Y=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},$=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},J=function(){function e(e){this.http=e}return e.prototype.get=function(){var e=this;return this.email_conf?B.a.of(this.email_conf):this.http.get("/api/email_conf").map(function(t){return e.email_conf=t})},e.prototype.post=function(e){var t=this;return this.http.post("/api/email_conf",e).map(function(e){return t.email_conf=e})},e=Y([Object(i.Injectable)(),$("design:paramtypes",[s.b])],e)}(),X=n("HOy/"),Z=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},K=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ee=function(){function e(e){this.fb=e,this.onEdited=new i.EventEmitter}return e.prototype.ngOnInit=function(){this.form=this.fb.group({editor:["test"]})},e.prototype.ngAfterViewInit=function(){var e=this;this.form.valueChanges.subscribe(function(t){return e.onEdited.emit(t.editor)})},e.prototype.setFocus=function(e){e.focus()},e.prototype.patchValue=function(e){this.form.controls.editor.patchValue(e||this.form.controls.editor.value+" patched!")},Z([Object(i.Input)(),K("design:type",String)],e.prototype,"elementId",void 0),Z([Object(i.Output)(),K("design:type",i.EventEmitter)],e.prototype,"onEdited",void 0),Z([Object(i.ViewChild)("editor"),K("design:type",X.a)],e.prototype,"editor",void 0),e=Z([Object(i.Component)({selector:"app-richtext",template:n("3wRP"),styles:[n("cmvB")]}),K("design:paramtypes",[a.a])],e)}(),te=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ne=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ie=function(){function e(e,t){this.alertsService=e,this.emailTplService=t}return e.prototype.onEdited=function(e){this.emailTplService.setTpl(e)},e.prototype.ngOnInit=function(){this.init()},e.prototype.ngAfterViewInit=function(){this.onEdited(this.emailTplService.hasTpl()?this.emailTplService.email_tpl.tpl:"")},e.prototype.tplCreate=function(e,t){var n=this;if(!e)return t(new TypeError("new_email_tpl must be defined"));this.emailTplService.create(e).subscribe(function(e){return n.handleEmailTpl(e,t)},this.handleError)},e.prototype.tplRead=function(e,t){var n=this;this.emailTplService.read(e).subscribe(function(e){return n.emailTplService.email_tpl=e,t(void 0,e)},function(e){return n.alertsService.add({type:"warning",msg:e}),t(e)})},e.prototype.tplDestroy=function(e){this.emailTplService.destroy(e).subscribe(function(e){return e},this.handleError)},e.prototype.save=function(){var e=this;this.tplCreate({tpl:this.emailTplService.email_tpl.tpl,createdAt:(new Date).toISOString()},function(t,n){t?e.alertsService.add(t):e.alertsService.add({type:"info",msg:"Updated email template"})})},e.prototype.init=function(){var e=this;this.tplRead("latest",function(t,n){return!t&&n&&e.editor.patchValue(n.tpl)})},e.prototype.handleEmailTpl=function(e,t){if(this.emailTplService.email_tpl=e,t)return t(void 0,e)},e.prototype.handleError=function(e){this.alertsService.add({type:"warning",msg:e})},te([Object(i.ViewChild)("editor"),ne("design:type",ee)],e.prototype,"editor",void 0),e=te([Object(i.Component)({selector:"app-email-tpl",template:n("N6X2"),styles:[n("3f7S")]}),ne("design:paramtypes",[f.a,W])],e)}(),re=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},oe=function(){function e(){}return e=re([Object(i.NgModule)({imports:[l.CommonModule,a.g,X.b],declarations:[ee],exports:[ee]})],e)}(),se=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ae=function(){function e(){}return e=se([Object(i.NgModule)({imports:[l.CommonModule,a.c,oe],declarations:[ie],exports:[ie]})],e)}(),ce=(n("xgm2"),this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}),le=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ue=function(e){for(var t,n={},i=e.substring(1),r=/([^&=]+)=([^&]*)/g;t=r.exec(i);)n[decodeURIComponent(t[1])]=decodeURIComponent(t[2]);return n},fe=function(){function e(e,t){this.http=e,this.authService=t,this.params=ue(location.hash)}return t=e,e.genNonce=function(){var e="0123456789ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvwxyz",t=new Uint8Array(32),n=[];return window.crypto.getRandomValues(t),t.forEach(function(t){return n.push(e[t%e.length])}),n.join("")},e.getHostOrigin=function(){return window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")},Object.defineProperty(e.prototype,"tenant_id",{get:function(){if(!this._tenant_id)throw TypeError("tenant_id must be defined. Did you run MsAuthService.setup?");return this._tenant_id},set:function(e){this._tenant_id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"client_id",{get:function(){if(!this._client_id)throw TypeError("client_id must be defined. Did you run MsAuthService.setup?");return this._client_id},set:function(e){this._client_id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"access_token",{get:function(){return this._access_token||(this._access_token=localStorage.getItem("ms-access-token")),this._access_token},set:function(e){this._access_token=e,localStorage.setItem("ms-access-token",e)},enumerable:!0,configurable:!0}),e.prototype.setup=function(e,t){this.tenant_id=e,this.client_id=t},e.prototype.login=function(){console.info("this.params['id_token'] =",this.params.id_token),console.info("this.params['access_token'] =",this.params.access_token),null!==this.params.id_token?this.getAccessToken():null!==this.params.access_token&&(this.access_token=this.params.access_token)},e.prototype.logout=function(){localStorage.removeItem("ms-access-token"),this._access_token=null},e.prototype.getAccessToken=function(e){var t=new L.e;t.set("response_type","token"),t.appendAll(this.genParams(e)),t.set("resource","https://graph.microsoft.com"),t.set("prompt","none"),window.location.href="https://login.microsoftonline.com/"+this.tenant_id+"/oauth2/authorize?"+t},e.prototype.sendEmail=function(e){var t=this,n=new L.d({headers:new L.a({Authorization:"Bearer "+this.access_token,"Content-Type":"application/json"})}),i={message:{subject:e.subject,toRecipients:[{emailAddress:{address:e.recipient}}],body:{content:e.content,contentType:"html"}}};return this.http.post("https://graph.microsoft.com/v1.0/users/me/sendMail",i,n).map(function(e){return 202!==e.status&&B.a.throw(new Error("Expected response.status of 202 got "+e.status+".\n           Body: "+e.text())),e}).catch(function(e){var n=JSON.parse(e._body).error;return"Access token has expired."===n.message&&t.getAccessToken(),B.a.throw(n)})},e.prototype.genParams=function(e){var n=new L.e;return n.set("client_id",this.client_id),console.info("genParams::client_id =",this.client_id),n.set("redirect_uri",t.getHostOrigin()),n.set("state",e||window.location.pathname),n.set("nonce",t.genNonce()),n},e=t=ce([Object(i.Injectable)(),le("design:paramtypes",[L.b,b.a])],e);var t}(),pe=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},de=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},he=function(){function e(e,t,n,i){this.alertsService=e,this.msAuthService=t,this.emailConfService=n,this.emailTplService=i,this.isCollapsed=!0,this.mail_base={}}return Object.defineProperty(e.prototype,"client_id",{get:function(){return this._client_id||this.emailConfService.email_conf?this.emailConfService.email_conf.client_id:null},set:function(e){this._client_id=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tenant_id",{get:function(){return this._tenant_id||this.emailConfService.email_conf?this.emailConfService.email_conf.tenant_id:null},set:function(e){this._tenant_id=e},enumerable:!0,configurable:!0}),e.prototype.ngOnInit=function(){this.emailConfService.get().subscribe(function(e){return console.info("email_conf ",e)},console.error)},e.prototype.login=function(){this.msAuthService.login()},e.prototype.loggedIn=function(){return!!this.msAuthService.access_token},e.prototype.logout=function(){this.msAuthService.logout()},e.prototype.sendTestEmail=function(){var e=this;console.info("MsAuthComponent::sendTestEmail"),this.msAuthService.sendEmail({recipient:this.mail_base.recipient,subject:this.mail_base.subject,content:this.emailTplService.email_tpl.tpl}).subscribe(function(t){return console.info(t)||e.alertsService.add({type:"info",msg:"Sent email"})},console.error)},e.prototype.toggleCollapse=function(){this.isCollapsed=!this.isCollapsed},e.prototype.updateAuth=function(){var e=this;this.emailConfService.post({client_id:this._client_id,tenant_id:this._tenant_id,access_token:this.msAuthService.access_token}).subscribe(function(t){return console.info(t)||e.alertsService.add({type:"info",msg:"Updated auth"})},function(e){return console.error(e)})},e=pe([Object(i.Component)({selector:"app-ms-auth",template:n("Igq0"),styles:[n("8xD6")]}),de("design:paramtypes",[f.a,fe,J,W])],e)}(),me=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ge=function(){function e(){}return e=me([Object(i.NgModule)({imports:[l.CommonModule,a.c,L.c,u.c.forRoot()],providers:[fe],declarations:[he],exports:[he]})],e)}(),be=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ye=function(){function e(){}return e=be([Object(i.NgModule)({imports:[l.CommonModule,L.c,a.c,ae,ge],declarations:[P],providers:[W,J]})],e)}(),ve=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},_e=function(){function e(){}return e=ve([Object(i.NgModule)({imports:[l.CommonModule,U,ye,c.c,c.c.forChild(q)],declarations:[N]})],e)}(),ke=(n("lMWm"),this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}),je=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Oe=function(){function e(e){this.http=e}return e.prototype.get=function(){return this.last_resp?B.a.of(this.last_resp):this.http.get("/api")},e=ke([Object(i.Injectable)(),je("design:paramtypes",[s.b])],e)}(),Re=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Se=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},we=function(){function e(e){this.serverStatusService=e,this.serverStatus={}}return e.prototype.ngOnInit=function(){var e=this;this.serverStatus={version:"App 0.0.31; "},this.serverStatusService.get().subscribe(function(t){return e.serverStatus.version+="API "+t.version},function(t){return e.serverStatus.version+="API server not available"})},Re([Object(i.Input)(),Se("design:type",Object)],e.prototype,"serverStatus",void 0),e=Re([Object(i.Component)({selector:"app-api-version",template:n("vqKx"),styles:[n("IH5k")]}),Se("design:paramtypes",[Oe])],e)}(),Pe=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},xe=function(){function e(){}return e=Pe([Object(i.NgModule)({imports:[l.CommonModule],providers:[Oe],declarations:[we],exports:[we]})],e)}(),Ce=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Ie=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ze=function(){function e(){}return e=Ce([Object(i.Component)({selector:"app-footer",template:n("f6ft"),styles:[n("mIxc")]}),Ie("design:paramtypes",[])],e)}(),Ae=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Qe=function(){function e(){}return e=Ae([Object(i.NgModule)({imports:[l.CommonModule,c.c,xe],providers:[Oe],declarations:[ze],exports:[ze]})],e)}(),De=n("Bj4q"),Te=n("vit7"),Ee=n("8WWY"),Me=n("dBtz"),Fe=n("yXRu"),Ne=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},qe=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ge=function(){function e(e,t){this.authService=e,this.http=t}return e.prototype.create=function(e){return this.http.post("/api/risk_stats",e)},e.prototype.read=function(e){return this.http.get("/api/risk_stats/"+e)},e.prototype.update=function(e,t){return this.http.put("/api/risk_stats/"+e.createdAt,t)},e.prototype.destroy=function(e){return this.http.delete("/api/risk_stats/"+e)},e=Ne([Object(i.Injectable)(),qe("design:paramtypes",[b.a,s.b])],e)}(),Ue=(n("owTz"),this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}),Le=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},Ve=function(){function e(e){this.http=e}return e.prototype.create=function(e){return this.http.post("/api/risk_res",e)},e.prototype.read=function(e){return this.http.get("/api/risk_res/"+e)},e.prototype.update=function(e,t){return this.http.put("/api/risk_res/"+e,t)},e.prototype.destroy=function(e){return this.http.delete("/api/risk_res/"+e)},e=Ue([Object(i.Injectable)(),Le("design:paramtypes",[s.b])],e)}(),He=n("QttI"),We=n("YxrS"),Be=(n("VwFy"),function(){function e(e){this.riskQuiz=e}return e.prototype.calcRisk=function(e){this.study=Object(We.ethnicity2study)(e)[this.riskQuiz.ethnicity];var t={study:this.study,age:this.riskQuiz.age,gender:this.riskQuiz.gender};this.risk=+Object(We.risk_from_study)(e,t).toPrecision(4),this.risks=Object(We.risks_from_study)(e,t),this.multiplicative_risks=Object(We.calc_default_multiplicative_risks)(e,{age:this.riskQuiz.age,diabetes:this.riskQuiz.diabetes,myopia:this.riskQuiz.myopia,family_history:this.riskQuiz.sibling||this.riskQuiz.parent})},e.prototype.toJSON=function(){return{age:this.riskQuiz.age,gender:this.riskQuiz.gender,ethnicity:this.riskQuiz.ethnicity,study:this.study,parent:this.riskQuiz.parent,sibling:this.riskQuiz.sibling,myopia:this.riskQuiz.myopia,diabetes:this.riskQuiz.diabetes,client_risk:this.client_risk}},e}()),Ye=Object.freeze({indigo:"#14143e",pink:"#fd1c49",orange:"#ff6e00",yellow:"#f0c800",mint:"#00efab",cyan:"#05d1ff",purple:"#841386",white:"#fff",darkgrey:"darkgrey",teal:"#5AA454",darkred:"#A10A28",gold:"#C7B42C",grey:"#AAAAAA"}),$e=function(e){return He.compare(e,5)<1?Ye.darkgrey:He.compare(e,25)<1?Ye.cyan:He.compare(e,50)<1?Ye.mint:He.compare(e,75)<1?Ye.orange:Ye.pink},Je=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Xe=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)};He.config({number:"BigNumber",precision:5});var Ze=function(){function e(e,t,n,r){var o=this;this.route=e,this.router=t,this.riskStatsService=n,this.riskResService=r,this.submitted=!1,this.most_at_risk="",this.isCollapsed=!0,this.id=void 0,this.progressGraph={bgRadius:60,bgColor:Ye.indigo,rounded:!1,reverse:!1,animationSecs:1,labels:[],segments:[]},this.submittedChange=new i.EventEmitter,this.colorScheme={domain:[Ye.teal,Ye.darkred,Ye.gold,Ye.grey]},this.pieAdvColorScheme=this.colorScheme,this.autoScale=!0,this.pieData=[],this.pieAdvDim=[700,400],this.pieAdvData=[],this.pieAdvLabel="times more at risk",this.pieAdvGradient=!0,this.pie_grid=!1,this.show_pie_adv=!1,this.added_risk=!1,this.gauge=!1,this.show_treemap=!1,this.treemap_legend=[],this.submissionHeader=[],this.labelFormat=function(e){return o.treemap_legend.findIndex(function(t){return t.color===e.data.fill})<0&&o.treemap_legend.push({color:e.data.fill,name:e.data.data.name,value:e.data.data.value}),o.treemap_legend.sort(function(e,t){return e.value<t.value}),{"Chinese [Singapore: urban]":"Chinese","White European (Canadian; Italian; Irish; Welsh; Scottish)":"White (Can.)","White (Northern European: Australian)":"White (Aus.)"}[e.data.data.name]||e.data.data.name}}return e.prototype.redo=function(){this.submittedChange.emit(!1),this.router.navigate(["/"]).catch(console.error)},e.prototype.ngOnInit=function(){this.riskQuiz instanceof Be||(this.riskQuiz=new Be(this.riskQuiz))},e.prototype.ngAfterContentInit=function(){var e=this;this.submitted?this.prepareView():this.route.params.switchMap(function(t){return e.id=+t.id,e.riskResService.read(e.id)}).subscribe(function(t){e.riskQuiz=new Be(t),e.submitted=!0,e.prepareView()})},e.prototype.toggleCollapse=function(){this.isCollapsed=!this.isCollapsed},e.prototype.idWithUrl=function(){return fe.getHostOrigin()+"/results/"+this.id},e.prototype.onPieGridSelect=function(e){console.log(e)},e.prototype.pieAdvOnSelect=function(e){console.log(e)},e.prototype.prepareView=function(){var e=this;this.submissionHeader=Object.keys(this.riskQuiz.riskQuiz).filter(function(e){return-1===["createdAt","updatedAt","id","client_risk"].indexOf(e)}),this.submissionRow=Object.keys(this.riskQuiz.riskQuiz).map(function(t){return(n={})[t]=null!=e.riskQuiz.riskQuiz[t]&&e.riskQuiz.riskQuiz[t],n;var n}).reduce(function(e,t){return Object.assign(e,t)},{}),this.riskStatsService.read("latest").subscribe(function(t){e.riskStatsService.risk_json=t.risk_json;try{e.riskQuiz.calcRisk(e.riskStatsService.risk_json)}catch(t){e.router.navigate(["/"]).catch(console.error)}e.html_of_all_refs=JSON.parse(e.riskStatsService.risk_json.html_of_all_refs),e.html_of_last_note=e.riskStatsService.risk_json.global_notes.pop(),e.notes=e.riskStatsService.risk_json.global_notes,e.riskStatsService.risk=e.riskQuiz.risk,e.riskQuiz.ref=e.riskStatsService.risk_json.studies[e.riskQuiz.study].ref;var n,i,r=Object(We.familial_risks_from_study)(e.riskStatsService.risk_json,e.riskQuiz.toJSON()),o=(n=He.multiply(He.divide(e.riskQuiz.risks.lastIndexOf(e.riskQuiz.risk)+1,e.riskQuiz.risks.length),100),(i=r.reduce(function(e,t){return e+t},1)+n)>100?100:i),s=function(e){switch(!0){case He.smallerEq(e,25):return"least";case He.smallerEq(e,50):return"average";case He.smallerEq(e,75):return"2nd greatest";case He.larger(e,75):default:return"greatest"}}(o);e.most_at_risk=e.riskQuiz.risks.lastIndexOf(e.riskQuiz.risk)+1+" / "+e.riskQuiz.risks.length,e.riskQuiz.relative_risks=Object(We.calc_relative_risk)(e.riskStatsService.risk_json,e.riskQuiz.riskQuiz),e.show_treemap=!0,e.gaugeView(o,s),e.pieAdvView(e.riskQuiz.multiplicative_risks),e.riskQuiz.client_risk=+o.toPrecision(4),e.recommendation="We recommend you see an eye-health professional ",o<=25?(e.recommendation+=" in the next two years.",e.recommendation_subtitle="Unless you've seen one in the last 2 years"):o<=50?(e.recommendation+=" in the next year.",e.recommendation_subtitle="Unless you've seen one in the last year"):o<=75?(e.recommendation+=" in the next 6 months.",e.recommendation_subtitle="Unless you've seen one recently."):(e.recommendation+=" ASAP.",e.recommendation_subtitle="Unless you've seen one recently."),null==e.id?e.riskResService.create(e.riskQuiz.toJSON()).subscribe(function(t){e.id=t.id,e.share_url=e.idWithUrl()},console.error):e.share_url=e.idWithUrl()},console.error)},e.prototype.gaugeView=function(e,t){this.progressGraph.labels.push(new Fe.a({color:Ye.white,text:"risk",x:0,y:20,fontSize:"1em"}),new Fe.a({color:$e(e),text:t,x:0,y:0,fontSize:"2em"})),this.progressGraph.segments.push(new Fe.c({value:e,color:$e(e),borderWidth:20})),this.gauge=!0},e.prototype.pieAdvView=function(e){this.pieAdvData=Object.keys(e).map(function(t){return{name:t,value:e[t]}}).filter(function(e){return e.value>1}),this.show_pie_adv=this.added_risk=this.riskQuiz.riskQuiz.sibling||this.riskQuiz.riskQuiz.parent},Je([Object(i.Input)(),Xe("design:type",Be)],e.prototype,"riskQuiz",void 0),Je([Object(i.Input)(),Xe("design:type",Object)],e.prototype,"submitted",void 0),Je([Object(i.Output)(),Xe("design:type",i.EventEmitter)],e.prototype,"submittedChange",void 0),e=Je([Object(i.Component)({selector:"app-risk-quiz-form-submitted",template:n("zd7U"),styles:[n("e6R8")]}),Xe("design:paramtypes",[c.a,c.b,Ge,Ve])],e)}(),Ke=[{path:"results",component:Ze},{path:"results/:id",component:Ze}],et=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},tt=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},nt=function(){function e(){this.numToColour=$e}return e.prototype.ngAfterViewInit=function(){},et([Object(i.Input)(),tt("design:type",Number)],e.prototype,"risk_value",void 0),e=et([Object(i.Component)({selector:"app-risk-pointer",template:n("lEF6"),styles:[n("GFD+")]}),tt("design:paramtypes",[])],e)}(),it=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},rt=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ot=function(){function e(e,t){this.fb=e,this.riskStatsService=t,this.riskQuiz=new Be({}),this.submitted=!1,this.isCopied=!1,this.active=!0,this.formErrors={gender:"",age:"",ethnicity:"",myopia:"",diabetes:""},this.validationMessages={gender:{required:"Gender is required."},age:{required:"Age is required."},ethnicity:{required:"Ethnicity is required."}},this.doClose=function(){return document.getElementById("parent").focus()}}return e.prototype.ngAfterViewInit=function(){var e=this;this.riskStatsService.read("latest").subscribe(function(t){e.riskStatsService.risk_json=t.risk_json,e.ethnicity2study=Object(We.ethnicity2study)(e.riskStatsService.risk_json),e.all_ethnicities=e.ethnicities=Object.keys(e.ethnicity2study).sort()},console.error)},e.prototype.ngOnInit=function(){this.buildForm()},e.prototype.onSubmit=function(){this.submitted=!0,null!=this.riskForm.value.ethnicity&&this.riskForm.value.ethnicity.length&&this.riskForm.value.ethnicity instanceof Array&&(this.riskForm.value.ethnicity=this.riskForm.value.ethnicity[0].id),this.riskQuiz=new Be(this.riskForm.value)},e.prototype.addRisk=function(){var e=this;this.riskQuiz=new Be({}),this.buildForm(),this.active=!1,setTimeout(function(){return e.active=!0},0)},e.prototype.buildForm=function(){var e=this;this.riskForm=this.fb.group({age:[this.riskQuiz.riskQuiz.age,[a.h.required]],gender:[this.riskQuiz.riskQuiz.gender,[a.h.required]],ethnicity:[this.riskQuiz.riskQuiz.ethnicity,a.h.required],sibling:[this.riskQuiz.riskQuiz.sibling],parent:[this.riskQuiz.riskQuiz.parent],myopia:[this.riskQuiz.riskQuiz.myopia],diabetes:[this.riskQuiz.riskQuiz.diabetes]}),this.riskForm.valueChanges.subscribe(function(t){return e.onValueChanged(t)}),this.onValueChanged()},e.prototype.onValueChanged=function(e){if(this.riskForm){var t=this.riskForm;for(var n in this.formErrors)if(this.formErrors.hasOwnProperty(n)){this.formErrors[n]="";var i=t.get(n);if(i&&i.dirty&&!i.valid){var r=this.validationMessages[n];for(var o in i.errors)i.errors.hasOwnProperty(o)&&(this.formErrors[n]+=r[o]+" ");!0}}}},e.prototype.selected_ethnicity=function(e){null!=e&&e.length&&(this.riskQuiz.riskQuiz.ethnicity=this.riskForm.value.ethnicity=e[0].id)},e=it([Object(i.Component)({selector:"app-risk-quiz-form",template:n("4nrF"),styles:[n("SiWZ")]}),rt("design:paramtypes",[a.a,Ge])],e)}(),st=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},at=function(){function e(){}return e=st([Object(i.NgModule)({imports:[l.CommonModule,a.g,De.a,a.c,c.c,c.c.forChild(Ke),u.f.forRoot(),Fe.b,u.c.forRoot(),Te.a,Ee.a,Me.NgxChartsModule,u.d.forRoot()],providers:[Ge,Ve],declarations:[ot,Ze,nt],exports:[ot]})],e)}(),ct=(n("MDfR"),this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s}),lt=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},ut=function(){function e(e,t){this.router=e,this.alertsService=t}return e.prototype.intercept=function(e,t){var n=this;return t.handle(b.a.loggedIn()?e.clone({headers:e.headers.set("X-Access-Token",b.a.getAccessToken())}):e).catch(function(e,t){if(e instanceof s.d)switch(e.status){case 403:n.router.isActive("auth",!1)?n.router.url.indexOf("auth")<0&&n.alertsService.add({code:e.status,message:e.error.message}):(n.alertsService.add("Authentication required"),n.router.navigate(["auth"],{queryParams:{redirectUrl:n.router.url}}).then(function(e){return e||n.alertsService.add("Unable to route to /auth")}).catch(B.a.throw));break;default:return B.a.throw(e)}return B.a.throw(e)})},e=ct([Object(i.Injectable)(),lt("design:paramtypes",[c.b,f.a])],e)}(),ft=n("FQYD"),pt=[{path:"",component:ot},{path:"auth",loadChildren:"app/auth/auth.module#AuthModule"},{path:"admin",component:N}],dt=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},ht=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},mt=function(){function e(e,t,n,i,r,o){this.authService=e,this.appService=t,this.emailConfService=n,this.msAuthService=i,this.alertsService=r,this.router=o}return e.prototype.ngOnInit=function(){var e=this,t=ue(location.hash);Object.keys(t).length>0&&this.emailConfService.get().subscribe(function(n){console.info("AppComponent::conf",n),t.id_token&&e.msAuthService.getAccessToken(t.state),e.msAuthService.access_token=t.access_token,t.state&&e.router.navigateByUrl(decodeURIComponent(t.state))},console.error)},e.prototype.getBottom=function(){return{"margin-bottom":(this.alertsService.alerts.length?6*this.alertsService.alerts.length:6)+"em"}},e=dt([Object(i.Component)({selector:"glaucoma-risk-calculator",styles:[n("okgc")],template:n("5xMp")}),ht("design:paramtypes",[b.a,y.a,J,fe,f.a,c.b])],e)}(),gt=this&&this.__decorate||function(e,t,n,i){var r,o=arguments.length,s=o<3?t:null===i?i=Object.getOwnPropertyDescriptor(t,n):i;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)s=Reflect.decorate(e,t,n,i);else for(var a=e.length-1;a>=0;a--)(r=e[a])&&(s=(o<3?r(s):o>3?r(t,n,s):r(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},bt=function(){function e(){}return e=gt([Object(i.NgModule)({imports:[c.c,c.c.forRoot(pt),o.BrowserModule,s.c,a.c,O,Qe,U,ye,g,at,ft.AuthModule,_e],declarations:[mt],providers:[f.a,y.a,b.a,E,{provide:s.a,useClass:ut,multi:!0}],bootstrap:[mt]})],e)}();Object(i.enableProdMode)(),Object(r.a)().bootstrapModule(bt)},y69F:function(e,t){e.exports='<alert *ngFor="let alert of alertsService.alerts;let i = index" [type]="alert.type" dismissible="true"\n       (close)="closeAlert(i)"\n       style="color: #ffcc9a">\n  <h3>{{ alert?.msg }}</h3>\n</alert>\n'},zd7U:function(e,t){e.exports='<div *ngIf="submitted">\n  <div class="col" *ngIf="gauge">\n    <ng-gauge [bgRadius]=progressGraph.bgRadius\n              [bgColor]=progressGraph.bgColor\n              [rounded]=progressGraph.rounded\n              [reverse]=progressGraph.reverse\n              [animationSecs]=progressGraph.animationSecs\n              [labels]=progressGraph.labels\n              [segments]=progressGraph.segments>\n    </ng-gauge>\n  </div>\n  <h3 style="text-underline: single">\n    {{recommendation}}\n  </h3>\n  <h5 style="text-underline: single; font-style: italic;">\n    ({{recommendation_subtitle | lowercase}})\n  </h5>\n\n  <div class="card">\n    <div class="card-block">\n      <h2>Glaucoma prevalence in your population is: {{riskQuiz.risk}}%.</h2>\n\n      <h3>This puts you in the\n        <strong>{{most_at_risk}}</strong> most at risk subgroup.\n        <span *ngIf="added_risk">\n          Adding in <strong>family risk</strong>, and you have:\n          {{riskQuiz.client_risk}}% relative risk within your cohort.\n        </span>\n      </h3>\n    </div>\n  </div>\n\n  <h6>Based off submission:</h6>\n\n  <table class="table table-responsive table-striped">\n    <thead>\n    <tr>\n      <th *ngFor="let col of submissionHeader">\n        {{ col }}\n      </th>\n    </tr>\n    </thead>\n    <tbody>\n    <tr>\n      <td *ngFor="let col of submissionHeader">\n        {{ submissionRow[col] }}\n      </td>\n    </tr>\n    </tbody>\n  </table>\n\n  <br>\n  <button class="btn btn-default" (click)="redo()">Redo</button>\n  <br>\n  <hr>\n  <h5>Share with family and friends to calculate their own risk</h5>\n  <div class="btn-toolbar" role="toolbar" aria-label="Share">\n    <div class="btn-group mr-2" role="group" aria-label="email">\n      <button class="btn btn-lg btn-warning">Share as email</button>\n    </div>\n    <div class="btn-group mr-2" role="group" aria-label="facebook">\n      <a class="btn btn-lg btn-primary" [href]="\'https://www.facebook.com/sharer/sharer.php?u=\'+share_url"\n         target="_blank">\n        Share on facebook\n      </a>\n    </div>\n    <div class="btn-group mr-2" role="group" aria-label="twitter">\n      <a target="_blank" class="btn btn-lg btn-info"\n         [href]="\'https://twitter.com/intent/tweet?text=\'+\'Be glaucoma aware, assess your own risk. Here\u2019s what I got: \'+share_url"\n         data-size="large">\n        Tweet\n      </a>\n    </div>\n    <div class="btn-group" role="group" aria-label="copy-link">\n      <button class="btn btn-lg btn-outline" [class.btn-success]="isCopied" ngxClipboard\n              [cbContent]="share_url" (cbOnSuccess)="isCopied = true">\n        Copy link\n      </button>\n    </div>\n  </div>\n  <hr>\n  <button class="btn btn-secondary" (click)="toggleCollapse()" [class.btn-outline-secondary]="!isCollapsed">\n    Review references and submission\n  </button>\n  <div [collapse]="isCollapsed" class="card card-block card-header" *ngIf="!isCollapsed">\n    <div class="well well-lg">\n      <h6>Your submission</h6>\n\n      <div class="row">\n        <div class="col-xs-3"><em>Age</em></div>\n        <div class="col-xs-9  pull-left"><strong>&nbsp;{{ riskQuiz.riskQuiz.age }}</strong></div>\n      </div>\n      <div class="row">\n        <div class="col-xs-3"><em>Gender</em></div>\n        <div class="col-xs-9 pull-left"><strong>&nbsp;{{ riskQuiz.riskQuiz.gender }}</strong></div>\n      </div>\n      <div class="row">\n        <div class="col-xs-3"><em>Ethnicity</em></div>\n        <div class="col-xs-9 pull-left"><strong>&nbsp;{{ riskQuiz.riskQuiz.ethnicity }}</strong></div>\n      </div>\n      <div class="row">\n        <div class="col-xs-3"><em>Sibling with glaucoma</em></div>\n        <div class="col-xs-9 pull-left"><strong>&nbsp;{{ riskQuiz.riskQuiz.sibling || \'false\' }}</strong></div>\n      </div>\n      <div class="row" style="margin-bottom: 5px">\n        <div class="col-xs-3"><em>Parent with glaucoma</em></div>\n        <div class="col-xs-9 pull-left"><strong>&nbsp;{{ riskQuiz.riskQuiz.parent || \'false\' }}</strong></div>\n      </div>\n\n      \x3c!--<app-risk-pointer [risk_value]="riskQuiz.client_risk"></app-risk-pointer>--\x3e\n\n      <ngx-charts-pie-grid *ngIf="pie_grid"\n                           [view]="pieView"\n                           [scheme]="colorScheme"\n                           [results]="pieData"\n                           autoScale="true"\n                           (select)="onPieGridSelect($event)">\n      </ngx-charts-pie-grid>\n\n      <hr>\n\n      \x3c!--\n      (legendLabelClick)="onLegendLabelClick($event)"\n      [scheme]="colorScheme"\n      [gradient]="gradient"\n      (select)="treemapSelect($event)"--\x3e\n      <h4>Risk compared with other ethnicities of same age and gender</h4>\n      <div class="row" *ngIf="show_treemap">\n        <p>Hover over each box to view the comparative risk score.</p>\n        <ngx-charts-tree-map [labelFormatting]="labelFormat"\n                             [results]="riskQuiz.relative_risks.graphed_rr">\n        </ngx-charts-tree-map>\n\n        <table class="table table-responsive table-striped">\n          <thead>\n          <tr>\n            <th>Study</th>\n            <th>Prevalence</th>\n          </tr>\n          </thead>\n          <tbody>\n          <tr *ngFor="let leg of treemap_legend" [style.background-color]="leg.color">\n            <td>\n              {{leg.name}}\n            </td>\n            <td>\n              {{leg.value}}\n            </td>\n          </tr>\n          </tbody>\n        </table>\n      </div>\n\n      \x3c!--\n      <div class="row">\n        <pre>multiplicative_risks = {{riskQuiz.multiplicative_risks|json}}</pre>\n      </div>\n      <div class="row">\n        <pre>relative_risks = {{riskQuiz.relative_risks|json}}</pre>\n      </div>\n      --\x3e\n\n      \x3c!--\n      <h4>Other charts</h4>\n\n      <div class="container-fluid">\n        <div class="row justify-content-md-center">\n          <div class="col" *ngIf="show_pie_adv">\n            <ngx-charts-advanced-pie-chart [view]="pieAdvDim"\n                                           [scheme]="pieAdvColorScheme"\n                                           [results]="pieAdvData"\n                                           [gradient]="pieAdvGradient"\n\n                                           (select)="pieAdvOnSelect($event)">\n            </ngx-charts-advanced-pie-chart>\n            \x3c!-- [total-label]="pieAdvLabel" --\x3e\n      \x3c!--\n          </div>\n        </div>\n      </div>\n      --\x3e\n\n      <h4>Notes</h4>\n      <ul *ngFor="let note of notes">\n        <li>{{note}}</li>\n      </ul>\n      <ul>\n        <li [innerHTML]="html_of_last_note">hello</li>\n      </ul>\n\n      <h4>References</h4>\n      <div [innerHTML]="html_of_all_refs">hello</div>\n    </div>\n  </div>\n</div>\n'}},[0]);